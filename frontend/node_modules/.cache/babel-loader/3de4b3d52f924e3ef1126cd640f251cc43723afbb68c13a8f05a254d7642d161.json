{"ast":null,"code":"import{useState,useEffect}from\"react\";import\"@/App.css\";import{BrowserRouter,Routes,Route,Navigate}from\"react-router-dom\";import axios from\"axios\";import Landing from\"@/pages/Landing\";import Dashboard from\"@/pages/Dashboard\";import Settings from\"@/pages/Settings\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;const API=\"\".concat(BACKEND_URL,\"/api\");function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{checkSession();},[]);const checkSession=async()=>{try{// Check for session_id in URL hash (from Google OAuth)\nconst hash=window.location.hash;if(hash.includes('session_id=')){const sessionId=hash.split('session_id=')[1].split('&')[0];// Exchange session_id for user data\nconst response=await axios.get(\"\".concat(API,\"/auth/session\"),{headers:{'X-Session-ID':sessionId},withCredentials:true});if(response.data.authenticated){setIsAuthenticated(true);setUser(response.data.user);}// Clean URL\nwindow.history.replaceState({},document.title,window.location.pathname);}else{// Check existing session\nconst response=await axios.get(\"\".concat(API,\"/auth/session\"),{withCredentials:true});if(response.data.authenticated){setIsAuthenticated(true);setUser(response.data.user);}}}catch(error){console.error('Session check failed:',error);}finally{setLoading(false);}};const handleLogout=async()=>{try{await axios.post(\"\".concat(API,\"/auth/logout\"),{},{withCredentials:true});setIsAuthenticated(false);setUser(null);}catch(error){console.error('Logout failed:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen bg-gradient-to-br from-sky-50 to-blue-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Loading...\"})]})});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true}):/*#__PURE__*/_jsx(Landing,{setIsAuthenticated:setIsAuthenticated,setUser:setUser})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:isAuthenticated?/*#__PURE__*/_jsx(Dashboard,{user:user,onLogout:handleLogout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/settings\",element:isAuthenticated?/*#__PURE__*/_jsx(Settings,{user:user,onLogout:handleLogout}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})})});}export default App;","map":{"version":3,"names":["useState","useEffect","BrowserRouter","Routes","Route","Navigate","axios","Landing","Dashboard","Settings","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","API","concat","App","isAuthenticated","setIsAuthenticated","user","setUser","loading","setLoading","checkSession","hash","window","location","includes","sessionId","split","response","get","headers","withCredentials","data","authenticated","history","replaceState","document","title","pathname","error","console","handleLogout","post","className","children","path","element","to","replace","onLogout"],"sources":["/app/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport \"@/App.css\";\nimport { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport Landing from \"@/pages/Landing\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport Settings from \"@/pages/Settings\";\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\nconst API = `${BACKEND_URL}/api`;\n\nfunction App() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkSession();\n  }, []);\n\n  const checkSession = async () => {\n    try {\n      // Check for session_id in URL hash (from Google OAuth)\n      const hash = window.location.hash;\n      if (hash.includes('session_id=')) {\n        const sessionId = hash.split('session_id=')[1].split('&')[0];\n        \n        // Exchange session_id for user data\n        const response = await axios.get(`${API}/auth/session`, {\n          headers: { 'X-Session-ID': sessionId },\n          withCredentials: true\n        });\n        \n        if (response.data.authenticated) {\n          setIsAuthenticated(true);\n          setUser(response.data.user);\n        }\n        \n        // Clean URL\n        window.history.replaceState({}, document.title, window.location.pathname);\n      } else {\n        // Check existing session\n        const response = await axios.get(`${API}/auth/session`, {\n          withCredentials: true\n        });\n        \n        if (response.data.authenticated) {\n          setIsAuthenticated(true);\n          setUser(response.data.user);\n        }\n      }\n    } catch (error) {\n      console.error('Session check failed:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      await axios.post(`${API}/auth/logout`, {}, { withCredentials: true });\n      setIsAuthenticated(false);\n      setUser(null);\n    } catch (error) {\n      console.error('Logout failed:', error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-sky-50 to-blue-100\">\n        <div className=\"text-center\">\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"App\">\n      <BrowserRouter>\n        <Routes>\n          <Route\n            path=\"/\"\n            element={\n              isAuthenticated ? (\n                <Navigate to=\"/dashboard\" replace />\n              ) : (\n                <Landing setIsAuthenticated={setIsAuthenticated} setUser={setUser} />\n              )\n            }\n          />\n          <Route\n            path=\"/dashboard\"\n            element={\n              isAuthenticated ? (\n                <Dashboard user={user} onLogout={handleLogout} />\n              ) : (\n                <Navigate to=\"/\" replace />\n              )\n            }\n          />\n          <Route\n            path=\"/settings\"\n            element={\n              isAuthenticated ? (\n                <Settings user={user} onLogout={handleLogout} />\n              ) : (\n                <Navigate to=\"/\" replace />\n              )\n            }\n          />\n        </Routes>\n      </BrowserRouter>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,WAAW,CAClB,OAASC,aAAa,CAAEC,MAAM,CAAEC,KAAK,CAAEC,QAAQ,KAAQ,kBAAkB,CACzE,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,OAAO,KAAM,iBAAiB,CACrC,MAAO,CAAAC,SAAS,KAAM,mBAAmB,CACzC,MAAO,CAAAC,QAAQ,KAAM,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,KAAM,CAAAC,WAAW,CAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,CACrD,KAAM,CAAAC,GAAG,IAAAC,MAAA,CAAML,WAAW,QAAM,CAEhC,QAAS,CAAAM,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,eAAe,CAAEC,kBAAkB,CAAC,CAAGtB,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACuB,IAAI,CAAEC,OAAO,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACyB,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACd0B,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF;AACA,KAAM,CAAAC,IAAI,CAAGC,MAAM,CAACC,QAAQ,CAACF,IAAI,CACjC,GAAIA,IAAI,CAACG,QAAQ,CAAC,aAAa,CAAC,CAAE,CAChC,KAAM,CAAAC,SAAS,CAAGJ,IAAI,CAACK,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAACA,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAE5D;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAA5B,KAAK,CAAC6B,GAAG,IAAAhB,MAAA,CAAID,GAAG,kBAAiB,CACtDkB,OAAO,CAAE,CAAE,cAAc,CAAEJ,SAAU,CAAC,CACtCK,eAAe,CAAE,IACnB,CAAC,CAAC,CAEF,GAAIH,QAAQ,CAACI,IAAI,CAACC,aAAa,CAAE,CAC/BjB,kBAAkB,CAAC,IAAI,CAAC,CACxBE,OAAO,CAACU,QAAQ,CAACI,IAAI,CAACf,IAAI,CAAC,CAC7B,CAEA;AACAM,MAAM,CAACW,OAAO,CAACC,YAAY,CAAC,CAAC,CAAC,CAAEC,QAAQ,CAACC,KAAK,CAAEd,MAAM,CAACC,QAAQ,CAACc,QAAQ,CAAC,CAC3E,CAAC,IAAM,CACL;AACA,KAAM,CAAAV,QAAQ,CAAG,KAAM,CAAA5B,KAAK,CAAC6B,GAAG,IAAAhB,MAAA,CAAID,GAAG,kBAAiB,CACtDmB,eAAe,CAAE,IACnB,CAAC,CAAC,CAEF,GAAIH,QAAQ,CAACI,IAAI,CAACC,aAAa,CAAE,CAC/BjB,kBAAkB,CAAC,IAAI,CAAC,CACxBE,OAAO,CAACU,QAAQ,CAACI,IAAI,CAACf,IAAI,CAAC,CAC7B,CACF,CACF,CAAE,MAAOsB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC/C,CAAC,OAAS,CACRnB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAqB,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAzC,KAAK,CAAC0C,IAAI,IAAA7B,MAAA,CAAID,GAAG,iBAAgB,CAAC,CAAC,CAAE,CAAEmB,eAAe,CAAE,IAAK,CAAC,CAAC,CACrEf,kBAAkB,CAAC,KAAK,CAAC,CACzBE,OAAO,CAAC,IAAI,CAAC,CACf,CAAE,MAAOqB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,gBAAgB,CAAEA,KAAK,CAAC,CACxC,CACF,CAAC,CAED,GAAIpB,OAAO,CAAE,CACX,mBACEd,IAAA,QAAKsC,SAAS,CAAC,yFAAyF,CAAAC,QAAA,cACtGrC,KAAA,QAAKoC,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BvC,IAAA,QAAKsC,SAAS,CAAC,wFAAwF,CAAM,CAAC,cAC9GtC,IAAA,MAAGsC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,YAAU,CAAG,CAAC,EAC7C,CAAC,CACH,CAAC,CAEV,CAEA,mBACEvC,IAAA,QAAKsC,SAAS,CAAC,KAAK,CAAAC,QAAA,cAClBvC,IAAA,CAACT,aAAa,EAAAgD,QAAA,cACZrC,KAAA,CAACV,MAAM,EAAA+C,QAAA,eACLvC,IAAA,CAACP,KAAK,EACJ+C,IAAI,CAAC,GAAG,CACRC,OAAO,CACL/B,eAAe,cACbV,IAAA,CAACN,QAAQ,EAACgD,EAAE,CAAC,YAAY,CAACC,OAAO,MAAE,CAAC,cAEpC3C,IAAA,CAACJ,OAAO,EAACe,kBAAkB,CAAEA,kBAAmB,CAACE,OAAO,CAAEA,OAAQ,CAAE,CAEvE,CACF,CAAC,cACFb,IAAA,CAACP,KAAK,EACJ+C,IAAI,CAAC,YAAY,CACjBC,OAAO,CACL/B,eAAe,cACbV,IAAA,CAACH,SAAS,EAACe,IAAI,CAAEA,IAAK,CAACgC,QAAQ,CAAER,YAAa,CAAE,CAAC,cAEjDpC,IAAA,CAACN,QAAQ,EAACgD,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAE7B,CACF,CAAC,cACF3C,IAAA,CAACP,KAAK,EACJ+C,IAAI,CAAC,WAAW,CAChBC,OAAO,CACL/B,eAAe,cACbV,IAAA,CAACF,QAAQ,EAACc,IAAI,CAAEA,IAAK,CAACgC,QAAQ,CAAER,YAAa,CAAE,CAAC,cAEhDpC,IAAA,CAACN,QAAQ,EAACgD,EAAE,CAAC,GAAG,CAACC,OAAO,MAAE,CAE7B,CACF,CAAC,EACI,CAAC,CACI,CAAC,CACb,CAAC,CAEV,CAEA,cAAe,CAAAlC,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}